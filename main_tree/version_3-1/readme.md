This is next level of version 3. I recreated all algoritm and added new function getInt.
