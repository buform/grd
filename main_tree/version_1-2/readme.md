This version shows usage of two-way list. To this algorithm two-way list is very bad idea, but it is only for learning.
